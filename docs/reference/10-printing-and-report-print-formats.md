# Reference: Printing (DocType Print Formats + Report Print Formats) — Frappe v15

This reference explains how to produce **professional, consistent PDFs** using only Frappe framework tools,
with **no custom CSS** and no frontend build.

It covers:
- DocType Print Formats (Jinja templates)
- Report Print Formats (`{report_name}.html`) (client-side microtemplating)
- How to display attachments safely (avoid “broken image” icons for PDFs)

---

## 1) DocType Print Formats (Jinja)

### 1.1 What Frappe uses
- DocType print formats use **Jinja** templating.
- You can create formats using the Print Format Builder, then add Custom HTML blocks with Jinja.
- If you set **Standard = Yes** and Developer Mode is enabled, Frappe writes a JSON file in your app for versioning.

### 1.2 MPIT policy (no custom CSS)
- Do not use the “Custom CSS” field.
- Use Bootstrap classes (`table`, `table-bordered`, `text-right`, etc.) in the HTML.

### 1.3 Deterministic “standard print format export” procedure

**Goal:** end with a version-controlled file under the app, so printing works on a fresh site.

1) Ensure developer mode is enabled:
```bash
bench --site <site> set-config developer_mode 1
bench --site <site> clear-cache
```

2) In Desk (Awesomebar):
- Type **“New Print Format”**
- Select the DocType (e.g., `MPIT Budget`)
- Name the format exactly (examples):
  - `MPIT Budget (Professional)`
  - `MPIT Budget (Professional + Attachments)`
  - `MPIT Project (Professional)`
  - `MPIT Project (Professional + Attachments)`
- Set:
  - **Standard = Yes**
  - **Custom Format = Yes**
  - **Print Format Type = Jinja**
- Paste your template HTML.

3) Save. Confirm that a JSON file appears inside the app (path depends on Frappe export rules).
   Commit that file in the repo.

4) Repeat for all required formats.

> If the JSON file is not created, verify:
> - Developer mode is enabled for the site
> - Standard = Yes on the print format
> - You restarted bench after enabling developer mode

---

## 2) Attachments in DocType print formats (avoid broken PDF icons)

### 2.1 Why PDFs break when treated as images
- PDFs are not images; embedding them with `<img>` results in broken image icons in HTML/PDF.
- MPIT policy: print a clean list of attachments (file name + link), do not embed.

### 2.2 How to list attachments in Jinja (supported functions)

Frappe exposes whitelisted functions in Jinja templates, including `frappe.get_all` and `frappe.get_url`.

Recommended snippet (list files attached to the document):

```jinja
{% set files = frappe.get_all(
    "File",
    filters={"attached_to_doctype": doc.doctype, "attached_to_name": doc.name},
    fields=["file_name", "file_url"]
) %}

{% if files %}
  <h4>Attachments</h4>
  <ul>
  {% for f in files %}
    <li>
      <a href="{{ frappe.get_url() }}{{ f.file_url }}">{{ f.file_name }}</a>
    </li>
  {% endfor %}
  </ul>
{% endif %}
```

Notes:
- This prints links that work in HTML; PDFs generated by wkhtmltopdf may not keep clickable links depending on settings.
- If you need non-clickable links, print just the `file_name`.

---

## 3) Report Print Formats (`{report_name}.html`) — not Jinja

### 3.1 What Frappe uses
Report print formats are **client-side HTML templates** and use a JS microtemplating syntax (similar to Jinja, but not the same).

**How to add one**
- Create a file named `{report_name}.html` next to the report `.py/.js/.json` files.
- Example folder structure:
  - `mpit_current_budget_vs_actual/`
    - `mpit_current_budget_vs_actual.py`
    - `mpit_current_budget_vs_actual.js`
    - `mpit_current_budget_vs_actual.json`
    - `mpit_current_budget_vs_actual.html`  ← you add this

### 3.2 Template data contract
In the template you can access:
- `data` (list of row objects; keys are slugified labels)
- `filters`
- `report` (report view object)

### 3.3 Critical rule: avoid single quotes
The report print templating engine is sensitive to single quotes in some contexts.
Prefer double quotes in HTML attributes and JS strings.

### 3.4 Minimal MPIT report print template skeleton

```html
<div class="container">
  <h3><%= __("MPIT Report") %></h3>

  <p class="text-muted">
    <%= __("Printed on") %>: <%= frappe.datetime.now_datetime() %>
  </p>

  <table class="table table-bordered table-condensed">
    <thead>
      <tr>
        <th><%= __("Label 1") %></th>
        <th class="text-right"><%= __("Amount") %></th>
      </tr>
    </thead>
    <tbody>
      <% for (var i = 0; i < data.length; i++) { %>
        <tr>
          <td><%= data[i].label_1 || "" %></td>
          <td class="text-right"><%= format_currency(data[i].amount) %></td>
        </tr>
      <% } %>
    </tbody>
  </table>
</div>
```

---

## 4) Verification checklist (printing)

After adding print formats:
1) Open one Budget and one Project in Desk → Print → select each new print format → Preview works.
2) Export to PDF → layout is readable (no broken images).
3) Open each MPIT report → Print → template is applied and table renders.

If PDF output looks different than HTML preview:
- Check Print Settings and wkhtmltopdf behavior
- Reduce “fancy” HTML; keep to tables and simple layout
